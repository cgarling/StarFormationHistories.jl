<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Helper Functions · StarFormationHistories.jl</title><meta name="title" content="Helper Functions · StarFormationHistories.jl"/><meta property="og:title" content="Helper Functions · StarFormationHistories.jl"/><meta property="twitter:title" content="Helper Functions · StarFormationHistories.jl"/><meta name="description" content="Documentation for StarFormationHistories.jl."/><meta property="og:description" content="Documentation for StarFormationHistories.jl."/><meta property="twitter:description" content="Documentation for StarFormationHistories.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">StarFormationHistories.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><span class="tocitem">Deriving Star Formation Histories from Hess Diagrams</span><ul><li><a class="tocitem" href="../fitting/fitting_intro/">Background and Template Construction</a></li><li><a class="tocitem" href="../fitting/unconstrained/">High-Level Methods for Unconstrained Fitting</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Constrained Metallicity Evolution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../fitting/hierarchical/overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-3-2" type="checkbox"/><label class="tocitem" for="menuitem-2-3-2"><span class="docs-label">AMRs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../fitting/hierarchical/linear_amr/">Linear Age-Metallicity Relation</a></li><li><a class="tocitem" href="../fitting/hierarchical/log_amr/">Logarithmic Age-Metallicity Relation</a></li><li><a class="tocitem" href="../fitting/hierarchical/fixed_amr/">Fixed Age-Metallicity Relations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3-3"><span class="docs-label">MZRs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../fitting/hierarchical/MZR/MZR/">Mass-Metallicity Relations (MZRs)</a></li></ul></li><li><a class="tocitem" href="../fitting/hierarchical/dispersion_models/">Metallicity Dispersion Models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../fitting/internals/">Low-Level Functions</a></li><li><a class="tocitem" href="../fitting/kernels/">Kernels</a></li></ul></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../simulate/">Simulating Color-Magnitude Diagrams</a></li><li><a class="tocitem" href="../binaries/">Binary Systems</a></li><li class="is-active"><a class="tocitem" href>Helper Functions</a><ul class="internal"><li><a class="tocitem" href="#Distances-and-Sizes"><span>Distances and Sizes</span></a></li><li><a class="tocitem" href="#Magnitudes-and-Luminosities"><span>Magnitudes and Luminosities</span></a></li><li><a class="tocitem" href="#metallicity_helpers"><span>Metallicities</span></a></li><li><a class="tocitem" href="#phot_helpers"><span>Photometric Error and Completeness Models</span></a></li></ul></li><li><a class="tocitem" href="../doc_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Helper Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Helper Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cgarling/StarFormationHistories.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cgarling/StarFormationHistories.jl/blob/main/docs/src/helpers.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="helpers"><a class="docs-heading-anchor" href="#helpers">Helper Functions</a><a id="helpers-1"></a><a class="docs-heading-anchor-permalink" href="#helpers" title="Permalink"></a></h1><h2 id="Distances-and-Sizes"><a class="docs-heading-anchor" href="#Distances-and-Sizes">Distances and Sizes</a><a id="Distances-and-Sizes-1"></a><a class="docs-heading-anchor-permalink" href="#Distances-and-Sizes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.arcsec_to_pc" href="#StarFormationHistories.arcsec_to_pc"><code>StarFormationHistories.arcsec_to_pc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">arcsec_to_pc(arcsec, dist_mod)</code></pre><p>Converts on-sky angle in arcseconds to physical separation based on distance modulus under the small-angle approximation.</p><p class="math-container">\[r ≈ 10^{μ/5 + 1} \times \text{atan}(θ/3600)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L20-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.pc_to_arcsec" href="#StarFormationHistories.pc_to_arcsec"><code>StarFormationHistories.pc_to_arcsec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pc_to_arcsec(pc, dist_mod)</code></pre><p>Inverse of <a href="#StarFormationHistories.arcsec_to_pc"><code>arcsec_to_pc</code></a>.</p><p class="math-container">\[θ ≈ \text{tan}\left( r / 10^{μ/5 + 1} \right) \times 3600\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L29-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.distance_modulus" href="#StarFormationHistories.distance_modulus"><code>StarFormationHistories.distance_modulus</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_modulus(distance)</code></pre><p>Finds distance modulus for distance in parsecs.</p><p class="math-container">\[μ = 5 \times \log_{10}(d) - 5\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L2-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.distance_modulus_to_distance" href="#StarFormationHistories.distance_modulus_to_distance"><code>StarFormationHistories.distance_modulus_to_distance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_modulus_to_distance(dist_mod)</code></pre><p>Converts distance modulus to distance in parsecs.</p><p class="math-container">\[d = 10^{μ/5 + 1}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L11-L18">source</a></section></article><h2 id="Magnitudes-and-Luminosities"><a class="docs-heading-anchor" href="#Magnitudes-and-Luminosities">Magnitudes and Luminosities</a><a id="Magnitudes-and-Luminosities-1"></a><a class="docs-heading-anchor-permalink" href="#Magnitudes-and-Luminosities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.mag2flux" href="#StarFormationHistories.mag2flux"><code>StarFormationHistories.mag2flux</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mag2flux(m, zpt=0)</code></pre><p>Convert a magnitude <code>m</code> to a flux assuming a photometric zeropoint of <code>zpt</code>, defined as the magnitude of an object that produces one count (or data number, DN) per second.</p><pre><code class="language-julia-repl hljs">julia&gt; mag2flux(15.0, 25.0) ≈ exp10(4 * (25.0 - 15.0) / 10)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L48-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.flux2mag" href="#StarFormationHistories.flux2mag"><code>StarFormationHistories.flux2mag</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flux2mag(f, zpt=0)</code></pre><p>Convert a flux <code>f</code> to a magnitude assuming a photometric zeropoint of <code>zpt</code>, defined as the magnitude of an object that produces one count (or data number, DN) per second.</p><pre><code class="language-julia-repl hljs">julia&gt; flux2mag(10000.0, 25.0) ≈ 25.0 - 5 * log10(10000.0) / 2
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L58-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.magerr" href="#StarFormationHistories.magerr"><code>StarFormationHistories.magerr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">magerr(f, σf)</code></pre><p>Returns an error in magnitudes given a flux and a flux uncertainty.</p><pre><code class="language-julia-repl hljs">julia&gt; magerr(100.0, 1.0) ≈ 2.5 / log(10) * (1.0 / 100.0)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L68-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.fluxerr" href="#StarFormationHistories.fluxerr"><code>StarFormationHistories.fluxerr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fluxerr(f, σm)</code></pre><p>Returns an error in flux given a flux and a magnitude uncertainty.</p><pre><code class="language-julia-repl hljs">julia&gt; fluxerr(100.0, 0.01) ≈ (0.01 * 100.0) / 2.5 * log(10)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L78-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.snr_magerr" href="#StarFormationHistories.snr_magerr"><code>StarFormationHistories.snr_magerr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">snr_magerr(σm)</code></pre><p>Returns a signal-to-noise ratio <span>$(f/σf)$</span> given an uncertainty in magnitudes.</p><pre><code class="language-julia-repl hljs">julia&gt; snr_magerr(0.01) ≈ 2.5 / log(10) / 0.01
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L88-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.magerr_snr" href="#StarFormationHistories.magerr_snr"><code>StarFormationHistories.magerr_snr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">magerr_snr(snr)</code></pre><p>Returns a magnitude uncertainty given a signal-to-noise ratio <span>$(f/σf)$</span>.</p><pre><code class="language-julia-repl hljs">julia&gt; magerr_snr(100.0) ≈ 2.5 / log(10) / 100.0
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L98-L106">source</a></section></article><h2 id="metallicity_helpers"><a class="docs-heading-anchor" href="#metallicity_helpers">Metallicities</a><a id="metallicity_helpers-1"></a><a class="docs-heading-anchor-permalink" href="#metallicity_helpers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.Y_from_Z" href="#StarFormationHistories.Y_from_Z"><code>StarFormationHistories.Y_from_Z</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Y_from_Z(Z, Y_p=0.2485, γ=1.78)</code></pre><p>Calculates the helium mass fraction (Y) for a star given its metal mass fraction (Z) using the approximation <code>Y = Y_p + γ * Z</code>, with <code>Y_p</code> being the primordial helium abundance <code>Y_p=0.2485</code> as assumed for <a href="http://stev.oapd.inaf.it/cmd/">PARSEC</a> isochrones and <code>γ=1.78</code> matching the input scaling for PARSEC as well. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L113-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.X_from_Z" href="#StarFormationHistories.X_from_Z"><code>StarFormationHistories.X_from_Z</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">X_from_Z(Z[, Yp, γ])</code></pre><p>Calculates the hydrogen mass fraction (X) for a star given its metal mass fraction (Z) via <code>X = 1 - (Z + Y)</code>, with the helium mass fraction <code>Y</code> approximated via <a href="#StarFormationHistories.Y_from_Z"><code>StarFormationHistories.Y_from_Z</code></a>. You may also provide the primordial helium abundance <code>Y_p</code> and <code>γ</code> such that <code>Y = Y_p + γ * Z</code>; these are passed through to <code>X_from_Z</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L118-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.MH_from_Z" href="#StarFormationHistories.MH_from_Z"><code>StarFormationHistories.MH_from_Z</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MH_from_Z(Z, solZ=0.01524; Y_p = 0.2485, γ = 1.78)</code></pre><p>Calculates [M/H] = log(Z/X) - log(Z/X)⊙. Given the provided solar metal mass fraction <code>solZ</code>, it calculates the hydrogen mass fraction X for both the Sun and the provided <code>Z</code> with <a href="#StarFormationHistories.X_from_Z"><code>StarFormationHistories.X_from_Z</code></a>. You may also provide the primordial helium abundance <code>Y_p</code> and <code>γ</code> such that <code>Y = Y_p + γ * Z</code>; these are passed through to <code>X_from_Z</code>. </p><p>The present-day solar Z is measured to be 0.01524 (<a href="https://ui.adsabs.harvard.edu/abs/2011SoPh..268..255C/abstract">Caffau et al. 2011</a>), but for PARSEC isochrones an [M/H] of 0 corresponds to Z=0.01471. This is because of a difference between the Sun&#39;s initial and present helium content caused by diffusion. If you want to reproduce PARSEC&#39;s scaling, you should set <code>solZ=0.01471</code>.</p><p>This function is an approximation and may not be suitable for precision calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L125-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.dMH_dZ" href="#StarFormationHistories.dMH_dZ"><code>StarFormationHistories.dMH_dZ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dMH_dZ(Z, solZ=0.01524; Y_p = 0.2485, γ = 1.78)</code></pre><p>Partial derivative of <a href="#StarFormationHistories.MH_from_Z"><code>MH_from_Z</code></a> with respect to the input metal mass fraction <code>Z</code>. Used for <a href="../fitting/hierarchical/log_amr/#StarFormationHistories.LogarithmicAMR"><code>LogarithmicAMR</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L143-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.Z_from_MH" href="#StarFormationHistories.Z_from_MH"><code>StarFormationHistories.Z_from_MH</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Z_from_MH(MH, solZ=0.01524; Y_p = 0.2485, γ = 1.78)</code></pre><p>Calculates metal mass fraction <code>Z</code> assuming that the solar metal mass fraction is <code>solZ</code> and using the PARSEC relation for the helium mass fraction <code>Y = Y_p + γ * Z</code> with primordial helium abundance <code>Y_p = 0.2485</code>, and <code>γ = 1.78</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L151-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.dZ_dMH" href="#StarFormationHistories.dZ_dMH"><code>StarFormationHistories.dZ_dMH</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dZ_dMH(MH, solZ=0.01524; Y_p = 0.2485, γ = 1.78)</code></pre><p>Partial derivative of <a href="#StarFormationHistories.Z_from_MH"><code>Z_from_MH</code></a> with respect to the input metal abundance <code>MH</code>. Used for <a href="../fitting/hierarchical/log_amr/#StarFormationHistories.LogarithmicAMR"><code>LogarithmicAMR</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L173-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.mdf_amr" href="#StarFormationHistories.mdf_amr"><code>StarFormationHistories.mdf_amr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(unique_MH, mass_mdf) =
mdf_amr(coeffs::AbstractVector{&lt;:Number},
        logAge::AbstractVector{&lt;:Number},
        metallicities::AbstractVector{&lt;:Number})</code></pre><p>Calculates the mass-weighted metallicity distribution function given a set of <em>stellar mass coefficients</em> <code>coeffs</code> for stellar populations with logarithmic ages <code>logAge=log10(age [yr])</code> and metallicities given by <code>metallicities</code>. This is calculated as</p><p class="math-container">\[P_j = \frac{ \sum_k r_{j,k} \, [\text{M} / \text{H}]_k}{\sum_{j,k} r_{j,k} \, [\text{M} / \text{H}]_k}\]</p><p>where <span>$r_{j,k}$</span> are the elements of <code>coeffs</code> where <span>$j$</span> indexes over unique entries in <code>logAge</code> and <span>$k$</span> indexes over unique entries in <code>metallicities.</code> This is the same nomenclature used in the <a href="../fitting/hierarchical/overview/#metal_evo_intro">the documentation on constrained metallicity evolutions</a>. The return values are sorted so that <code>unique_MH</code> is in increasing order.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; mdf_amr([1.0, 2.0, 1.0], [10, 10, 10], [-2, -1.5, -1])
([-2.0, -1.5, -1.0], [0.25, 0.5, 0.25])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/fitting/mdf.jl#L3-L22">source</a></section><section><div><pre><code class="language-julia hljs">(unique_MH, mass_mdf) =
mdf_amr(coeffs::AbstractVector{&lt;:Number},
        logAge::AbstractVector{&lt;:Number},
        metallicities::AbstractVector{&lt;:Number},
        models::Union{AbstractVector{&lt;:AbstractMatrix{&lt;:Number}},
                      AbstractMatrix{&lt;:Number}})</code></pre><p>Calculates the number-weighted metallicity distribution function given a set of coefficients <code>coeffs</code> for stellar populations with logarithmic ages <code>logAge=log10(age [yr])</code>, metallicities given by <code>metallicities</code>, and Hess diagram templates <code>models</code>. This function constructs a composite Hess diagram (see <a href="../fitting/internals/#StarFormationHistories.composite!"><code>composite!</code></a> for definition) out of the <code>coeffs</code> and <code>models</code> that match each unique entry in <code>metallicites</code>. The sums over the bins of these composite Hess diagrams then give the total predicted number of stars in the Hess diagram viewport for each metallicity. The raw number counts for each unique metallicity are returned as <code>mass_mdf</code> – these can be renormalized afterward to sum to one by calculating <code>mass_mdf ./ sum(mass_mdf)</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; mdf_amr([1.0, 2.0, 1.0], [10, 10, 10], [-2, -1.5, -1],
               map(Base.Fix2(fill, (100, 100)), [1.0, 2.0, 1.0]))
([-2.0, -1.5, -1.0], [10000.0, 40000.0, 10000.0])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/fitting/mdf.jl#L37-L53">source</a></section></article><h2 id="phot_helpers"><a class="docs-heading-anchor" href="#phot_helpers">Photometric Error and Completeness Models</a><a id="phot_helpers-1"></a><a class="docs-heading-anchor-permalink" href="#phot_helpers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.Martin2016_complete" href="#StarFormationHistories.Martin2016_complete"><code>StarFormationHistories.Martin2016_complete</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">η(m) = Martin2016_complete(m, A, m50, ρ)</code></pre><p>Completeness model of <a href="https://ui.adsabs.harvard.edu/abs/2016ApJ...833..167M/abstract">Martin et al. 2016</a> implemented as their Equation 7:</p><p class="math-container">\[\eta(m) = \frac{A}{1 + \text{exp} \left( \frac{m - m_{50}}{\rho} \right)}\]</p><p><code>m</code> is the magnitude of interest, <code>A</code> is the maximum completeness, <code>m50</code> is the magnitude at which the data are 50% complete, and <code>ρ</code> is an effective slope modifier.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L189-L199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.exp_photerr" href="#StarFormationHistories.exp_photerr"><code>StarFormationHistories.exp_photerr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exp_photerr(m, a, b, c, d)</code></pre><p>Exponential model for photometric errors of the form</p><p class="math-container">\[\sigma(m) = a^{b \times \left( m-c \right)} + d\]</p><p>Reported values for some HST data were <code>a=1.05, b=10.0, c=32.0, d=0.01</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L202-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StarFormationHistories.process_ASTs" href="#StarFormationHistories.process_ASTs"><code>StarFormationHistories.process_ASTs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_ASTs(ASTs::Union{DataFrames.DataFrame,
                         TypedTables.Table},
             inmag::Symbol,
             outmag::Symbol,
             bins::AbstractVector{&lt;:Real},
             selectfunc;
             statistic=StatsBase.median)</code></pre><p>Processes a table of artificial stars to calculate photometric completeness, bias, and error across the provided <code>bins</code>. This method has no default implementation and is implemented in package extensions that rely on either <code>DataFrames.jl</code> or <code>TypedTables.jl</code> being loaded into your Julia session to load the relevant method. This method therefore requires Julia 1.9 or greater to use.</p><p><strong>Arguments</strong></p><ul><li><code>ASTs</code> is the table of artificial stars to be analyzed.</li><li><code>inmag</code> is the column name in symbol format (e.g., :F606Wi) that corresponds to the intrinsic (input) magnitudes of the artificial stars.</li><li><code>outmag</code> is the column name in symbol format (e.g., :F606Wo) that corresponds to the measured (output) magnitude of the artificial stars.</li><li><code>bins</code> give the bin edges to be used when computing the binned statistics.</li><li><code>selectfunc</code> is a method that takes a single row from <code>ASTs</code>, corresponding to a single artificial star, and returns a boolean that is <code>true</code> if the star is considered successfully measured.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>statistic</code> is the method that will be used to determine the bias and error, i.e., <code>bias = statistic(out .- in)</code> and <code>error = statistic(abs.(out .- in))</code>. By default we use <code>StatsBase.median</code>, but you could instead use a simple or sigma-clipped mean if so desired.</li></ul><p><strong>Returns</strong></p><p>This method returns a <code>result</code> of type <code>NTuple{4,Vector{Float64}}</code>. Each vector is of length <code>length(bins)-1</code>. <code>result</code> contains the following elements, each of which are computed over the provided <code>bins</code> considering only artificial stars for which <code>selectfunc</code> returned <code>true</code>:</p><ul><li><code>result[1]</code> contains the mean input magnitude of the stars in each bin.</li><li><code>result[2]</code> contains the completeness value measured for each bin, defined as the fraction of input stars in each bin for which <code>selectfunc</code> returned <code>true</code>.</li><li><code>result[3]</code> contains the photometric bias measured for each bin, defined as <code>statistic(out .- in)</code>, where <code>out</code> are the measured (output) magnitudes and <code>in</code> are the intrinsic (input) magnitudes.</li><li><code>result[4]</code> contains the photometric error measured for each bin, defined as <code>statistic(abs.(out .- in))</code>, with <code>out</code> and <code>in</code> defined as above.</li></ul><p><strong>Examples</strong></p><p>Let</p><ul><li><code>F606Wi</code> be a vector containing the input magnitudes of your artificial stars</li><li><code>F606Wo</code> be a vector containing the measured magnitudes of the artificial stars, where a value of 99.999 indicates a non-detection.</li><li><code>flag</code> be a vector of booleans that indicates whether the artificial star passed additional quality cuts (star-galaxy separation, etc.)</li></ul><p>You could call this method as</p><pre><code class="language-julia hljs">import TypedTables: Table
process_ASTs(Table(input=F606Wi, output=F606Wo, good=flag),
             :input, :output, minimum(F606Wi):0.1:maximum(F606Wi),
             x -&gt; (x.good==true) &amp; (x.output != 99.999))</code></pre><p>See also the tests in <code>test/utilities/process_ASTs_test.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgarling/StarFormationHistories.jl/blob/6aecabaf00f1af75a856ca1851b686c126526f38/src/utilities.jl#L215-L258">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../binaries/">« Binary Systems</a><a class="docs-footer-nextpage" href="../doc_index/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 3 March 2025 23:10">Monday 3 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
